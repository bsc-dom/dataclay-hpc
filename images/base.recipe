Bootstrap: docker
From: bscdataclay/base:2.1

%environment
	export JAVA8_HOME=/usr/lib/jvm/java-8
	export LC_CTYPE=en_US.UTF-8
	export LANG=en_US.UTF-8 
	export LANGUAGE=en_US:en 
	export LC_ALL=en_US.UTF-8
	export DATACLAY_HOME=/home/dataclayusr/dataclay
	export EXTRAE_HOME=/home/dataclayusr/.extrae
	export EXTRAE_VERSION=3.6.1
	export EXTRAE_SKIP_AUTO_LIBRARY_INITIALIZE=1
	export EXTRAE_JAR_PATH=${EXTRAE_HOME}/lib/javatrace.jar
	export EXTRAE_CONFIG_FILE=${DATACLAY_HOME}/extrae/extrae_basic.xml
	export LD_PRELOAD=${EXTRAE_HOME}/lib/libpttrace.so:${LD_PRELOAD}
	export PATH=${EXTRAE_HOME}/bin:${PATH}
	export LD_LIBRARY_PATH=${EXTRAE_HOME}/lib:${LD_LIBRARY_PATH}
	export VIRTUAL_ENV=${DATACLAY_HOME}/dataclay_venv
%startscript
	exec /.singularity.d/runscript $@
